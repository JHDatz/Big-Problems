library(tidyverse)
library(mosaic)
library(dplyr)
data0610<-read_csv("~/retrosheet/unzipped/data0610.csv")
data1115<-read_csv("~/retrosheet/unzipped/data1115.csv")
data1619<-read_csv("~/retrosheet/unzipped/data1619.csv")
data0610.err<-data0610 %>% 
  filter(ERR_CT>0) %>% 
  mutate("1"=PIT_ID,
         "2"=POS2_FLD_ID,
         "3"=POS3_FLD_ID,
         "4"=POS4_FLD_ID,
         "5"=POS5_FLD_ID,
         "6"=POS6_FLD_ID,
         "7"=POS7_FLD_ID,
         "8"=POS8_FLD_ID,
         "9"=POS9_FLD_ID,
         ERR1_ID=ifelse(ERR1_FLD_CD==1,PIT_ID,
                        ifelse(ERR1_FLD_CD==2,POS2_FLD_ID,
                               ifelse(ERR1_FLD_CD==3,POS3_FLD_ID,
                                      ifelse(ERR1_FLD_CD==4,POS4_FLD_ID,
                                             ifelse(ERR1_FLD_CD==5,POS5_FLD_ID,
                                                    ifelse(ERR1_FLD_CD==6,POS6_FLD_ID,
                                                           ifelse(ERR1_FLD_CD==7,POS7_FLD_ID,
                                                                  ifelse(ERR1_FLD_CD==8,POS8_FLD_ID,
                                                                         ifelse(ERR1_FLD_CD==9,POS9_FLD_ID,""))))))))),
         ERR2_ID=ifelse(ERR2_FLD_CD==1,PIT_ID,
                        ifelse(ERR2_FLD_CD==2,POS2_FLD_ID,
                               ifelse(ERR2_FLD_CD==3,POS3_FLD_ID,
                                      ifelse(ERR2_FLD_CD==4,POS4_FLD_ID,
                                             ifelse(ERR2_FLD_CD==5,POS5_FLD_ID,
                                                    ifelse(ERR2_FLD_CD==6,POS6_FLD_ID,
                                                           ifelse(ERR2_FLD_CD==7,POS7_FLD_ID,
                                                                  ifelse(ERR2_FLD_CD==8,POS8_FLD_ID,
                                                                         ifelse(ERR2_FLD_CD==9,POS9_FLD_ID,""))))))))),
         ERR3_ID=ifelse(ERR3_FLD_CD==1,PIT_ID,
                        ifelse(ERR3_FLD_CD==2,POS2_FLD_ID,
                               ifelse(ERR3_FLD_CD==3,POS3_FLD_ID,
                                      ifelse(ERR3_FLD_CD==4,POS4_FLD_ID,
                                             ifelse(ERR3_FLD_CD==5,POS5_FLD_ID,
                                                    ifelse(ERR3_FLD_CD==6,POS6_FLD_ID,
                                                           ifelse(ERR3_FLD_CD==7,POS7_FLD_ID,
                                                                  ifelse(ERR3_FLD_CD==8,POS8_FLD_ID,
                                                                         ifelse(ERR3_FLD_CD==9,POS9_FLD_ID,"")))))))))) %>% 
  select(GAME_ID,AWAY_TEAM_ID,"1","2","3","4","5","6","7","8","9",EVENT_CD,ERR_CT,ERR1_FLD_CD,ERR2_FLD_CD,ERR3_FLD_CD,ERR1_ID,ERR2_ID,ERR3_ID)
data1115.err<-data1115 %>% 
  mutate("1"=PIT_ID,
         "2"=POS2_FLD_ID,
         "3"=POS3_FLD_ID,
         "4"=POS4_FLD_ID,
         "5"=POS5_FLD_ID,
         "6"=POS6_FLD_ID,
         "7"=POS7_FLD_ID,
         "8"=POS8_FLD_ID,
         "9"=POS9_FLD_ID,
         ERR1_ID=ifelse(ERR1_FLD_CD==1,PIT_ID,
                        ifelse(ERR1_FLD_CD==2,POS2_FLD_ID,
                               ifelse(ERR1_FLD_CD==3,POS3_FLD_ID,
                                      ifelse(ERR1_FLD_CD==4,POS4_FLD_ID,
                                             ifelse(ERR1_FLD_CD==5,POS5_FLD_ID,
                                                    ifelse(ERR1_FLD_CD==6,POS6_FLD_ID,
                                                           ifelse(ERR1_FLD_CD==7,POS7_FLD_ID,
                                                                  ifelse(ERR1_FLD_CD==8,POS8_FLD_ID,
                                                                         ifelse(ERR1_FLD_CD==9,POS9_FLD_ID,"0"))))))))),
         ERR2_ID=ifelse(ERR2_FLD_CD==1,PIT_ID,
                        ifelse(ERR2_FLD_CD==2,POS2_FLD_ID,
                               ifelse(ERR2_FLD_CD==3,POS3_FLD_ID,
                                      ifelse(ERR2_FLD_CD==4,POS4_FLD_ID,
                                             ifelse(ERR2_FLD_CD==5,POS5_FLD_ID,
                                                    ifelse(ERR2_FLD_CD==6,POS6_FLD_ID,
                                                           ifelse(ERR2_FLD_CD==7,POS7_FLD_ID,
                                                                  ifelse(ERR2_FLD_CD==8,POS8_FLD_ID,
                                                                         ifelse(ERR2_FLD_CD==9,POS9_FLD_ID,"0"))))))))),
         ERR3_ID=ifelse(ERR3_FLD_CD==1,PIT_ID,
                        ifelse(ERR3_FLD_CD==2,POS2_FLD_ID,
                               ifelse(ERR3_FLD_CD==3,POS3_FLD_ID,
                                      ifelse(ERR3_FLD_CD==4,POS4_FLD_ID,
                                             ifelse(ERR3_FLD_CD==5,POS5_FLD_ID,
                                                    ifelse(ERR3_FLD_CD==6,POS6_FLD_ID,
                                                           ifelse(ERR3_FLD_CD==7,POS7_FLD_ID,
                                                                  ifelse(ERR3_FLD_CD==8,POS8_FLD_ID,
                                                                         ifelse(ERR3_FLD_CD==9,POS9_FLD_ID,"0")))))))))) %>% 
  select(GAME_ID,AWAY_TEAM_ID,"1","2","3","4","5","6","7","8","9",EVENT_CD,ERR_CT,ERR1_FLD_CD,ERR2_FLD_CD,ERR3_FLD_CD,ERR1_ID,ERR2_ID,ERR3_ID) %>% 
  filter(ERR_CT>0)
data1619.err<-data1619 %>% 
  mutate("1"=PIT_ID,
         "2"=POS2_FLD_ID,
         "3"=POS3_FLD_ID,
         "4"=POS4_FLD_ID,
         "5"=POS5_FLD_ID,
         "6"=POS6_FLD_ID,
         "7"=POS7_FLD_ID,
         "8"=POS8_FLD_ID,
         "9"=POS9_FLD_ID,
         ERR1_ID=ifelse(ERR1_FLD_CD==1,PIT_ID,
                        ifelse(ERR1_FLD_CD==2,POS2_FLD_ID,
                               ifelse(ERR1_FLD_CD==3,POS3_FLD_ID,
                                      ifelse(ERR1_FLD_CD==4,POS4_FLD_ID,
                                             ifelse(ERR1_FLD_CD==5,POS5_FLD_ID,
                                                    ifelse(ERR1_FLD_CD==6,POS6_FLD_ID,
                                                           ifelse(ERR1_FLD_CD==7,POS7_FLD_ID,
                                                                  ifelse(ERR1_FLD_CD==8,POS8_FLD_ID,
                                                                         ifelse(ERR1_FLD_CD==9,POS9_FLD_ID,"0"))))))))),
         ERR2_ID=ifelse(ERR2_FLD_CD==1,PIT_ID,
                        ifelse(ERR2_FLD_CD==2,POS2_FLD_ID,
                               ifelse(ERR2_FLD_CD==3,POS3_FLD_ID,
                                      ifelse(ERR2_FLD_CD==4,POS4_FLD_ID,
                                             ifelse(ERR2_FLD_CD==5,POS5_FLD_ID,
                                                    ifelse(ERR2_FLD_CD==6,POS6_FLD_ID,
                                                           ifelse(ERR2_FLD_CD==7,POS7_FLD_ID,
                                                                  ifelse(ERR2_FLD_CD==8,POS8_FLD_ID,
                                                                         ifelse(ERR2_FLD_CD==9,POS9_FLD_ID,"0"))))))))),
         ERR3_ID=ifelse(ERR3_FLD_CD==1,PIT_ID,
                        ifelse(ERR3_FLD_CD==2,POS2_FLD_ID,
                               ifelse(ERR3_FLD_CD==3,POS3_FLD_ID,
                                      ifelse(ERR3_FLD_CD==4,POS4_FLD_ID,
                                             ifelse(ERR3_FLD_CD==5,POS5_FLD_ID,
                                                    ifelse(ERR3_FLD_CD==6,POS6_FLD_ID,
                                                           ifelse(ERR3_FLD_CD==7,POS7_FLD_ID,
                                                                  ifelse(ERR3_FLD_CD==8,POS8_FLD_ID,
                                                                         ifelse(ERR3_FLD_CD==9,POS9_FLD_ID,"0")))))))))) %>% 
  select(GAME_ID,AWAY_TEAM_ID,"1","2","3","4","5","6","7","8","9",EVENT_CD,ERR_CT,ERR1_FLD_CD,ERR2_FLD_CD,ERR3_FLD_CD,ERR1_ID,ERR2_ID,ERR3_ID) %>% 
  filter(ERR_CT>0)